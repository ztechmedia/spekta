<?php 
if ((strpos(strtolower($_SERVER['SCRIPT_NAME']), strtolower(basename(__FILE__)))) !== false) { // NOT FALSE if the script"s file name is found in the URL
    header('HTTP/1.0 403 Forbidden');
    die('<h2>Direct access to this page is not allowed.</h2>');
}

$script = <<< "JS"
	
	function showReqOvertime(){var e,t=[],a={department_id:{url:Emp("getDepartment"),reload:!0},sub_department_id:{url:Emp("getSubDepartment"),reload:!1},division_id:{url:Emp("getDivision"),reload:!1}},i=mainTab.cells("master_overtime_requirement").attachLayout({pattern:"2U",cells:[{id:"a",header:!1},{id:"b",text:"Form Kebutuhan Lembur",header:!0,collapse:!0}]}),r=mainTab.cells("master_overtime_requirement").attachToolbar({icon_path:"./public/codebase/icons/",items:[{id:"refresh",text:"Refresh",type:"button",img:"refresh.png"},{id:"edit",text:"Ubah",type:"button",img:"edit.png",img_disabled:"edit_disabled.png"},{id:"searchtext",text:"Cari : ",type:"text"},{id:"search",text:"",type:"buttonInput",width:150}]}),l=i.cells("a").attachStatusBar();function n(){let e=s.getRowsNum();l.setText("Total baris: "+e)}var s=i.cells("a").attachGrid();function o(){i.cells("a").progressOn(),s.clearAndLoad(AppMaster2("reqOvertimeGrid",{search:r.getValue("search")}),n)}s.setHeader("No,Nama Kebutuhan,Kategori,Sub Unit (Ref),Bagian (Ref),Sub Bagian (Ref),Created By,Updated By,DiBuat"),s.attachHeader("#rspan,#text_filter,#select_filter,#select_filter,#select_filter,#select_filter,#text_filter,#text_filter,#text_filter"),s.setColSorting("str,str,str,str,str,str,str,str,str"),s.setColTypes("rotxt,rotxt,rotxt,rotxt,rotxt,rotxt,rotxt,rotxt,rotxt"),s.setColAlign("center,left,left,left,left,left,left,left,left"),s.setInitWidthsP("5,20,20,20,20,15,15,15,25"),s.enableSmartRendering(!0),s.enableMultiselect(!0),s.attachEvent("onXLE",(function(){i.cells("a").progressOff()})),s.init(),o(),r.attachEvent("onClick",(function(l){switch(l){case"refresh":r.setValue("search",""),o();break;case"edit":!function(){if(!s.getSelectedRowId())return eAlert("Pilih baris yang akan diubah!");i.cells("b").expand(),i.cells("b").showView("edit_loc");var r=(e=i.cells("b").attachForm([{type:"fieldset",offsetTop:30,offsetLeft:30,label:"Ubah Kebutuhan Lembur",list:[{type:"hidden",name:"id",label:"ID",readonly:!0},{type:"input",name:"name",label:"Nama Kebutuhan",labelWidth:130,inputWidth:250,required:!0},{type:"combo",name:"category",label:"Kategori",readonly:!0,required:!0,labelWidth:130,inputWidth:250,validate:"NotEmpty",options:[{value:"",text:""},{value:"Fasilitas",text:"Fasilitas"},{value:"Tenaga Kerja",text:"Tenaga Kerja"}]},{type:"combo",name:"department_id",label:"Sub Unit",readonly:!0,required:!0,labelWidth:130,inputWidth:250,connector:a.department_id},{type:"combo",name:"sub_department_id",label:"Bagian",readonly:!0,required:!0,labelWidth:130,inputWidth:250,connector:a.sub_department_id},{type:"combo",name:"division_id",label:"Sub Bagian",readonly:!0,required:!0,labelWidth:130,inputWidth:250,connector:a.division_id},{type:"input",name:"pic_emails",label:"PIC Email",required:!0,labelWidth:130,inputWidth:250},{type:"block",offsetTop:30,list:[{type:"button",name:"update",className:"button_update",offsetLeft:15,value:"Simpan"},{type:"newcolumn"},{type:"button",name:"cancel",className:"button_no",offsetLeft:30,value:"Cancel"}]}]}])).getCombo("department_id"),l=e.getCombo("sub_department_id"),n=e.getCombo("division_id");function c(){r.load(Emp("getDepartment",{select:e.getItemValue("department_id")})),l.load(Emp("getSubDepartment",{deptId:e.getItemValue("department_id"),select:e.getItemValue("sub_department_id")})),n.load(Emp("getDivision",{subDeptId:e.getItemValue("sub_department_id"),select:e.getItemValue("division_id")})),r.attachEvent("onChange",(function(t,a){clearComboReload(e,"sub_department_id",Emp("getSubDepartment",{deptId:t}))})),l.attachEvent("onChange",(function(t,a){clearComboReload(e,"division_id",Emp("getDivision",{subDeptId:t}))})),t=e.getItemValue("pic_emails").split(",")}fetchFormData(AppMaster2("reqOvertimeForm",{id:s.getSelectedRowId()}),e,null,null,c),e.attachEvent("onFocus",(function(a,i){"pic_emails"===a&&function(e){if(""===e.getItemValue("sub_department_id"))return eAlert("Bagian belum di pilih!");var a=createWindow("pic_window","Karyawan",900,400);myWins.window("pic_window").skipMyCloseEvent=!0,a.attachToolbar({icon_path:"./public/codebase/icons/",items:[{id:"save",text:"Simpan",type:"button",img:"ok.png"}]}).attachEvent("onClick",(function(a){switch(a){case"save":t=[];for(let e=0;e<picGrid.getRowsNum();e++){let a=picGrid.getRowId(e);1==picGrid.cells(a,1).getValue()&&t.push(a)}e.setItemValue("pic_emails",t),closeWindow("pic_window")}}));let i=a.attachStatusBar();function r(){var e=picGrid.getRowsNum();i.setText("Total baris: "+e),t.length>0&&t.map((e=>{picGrid.doesRowExist(e)&&picGrid.cells(e,1).setValue(1)}))}a.progressOn(),picGrid=a.attachGrid(),picGrid.setImagePath("./public/codebase/imgs/"),picGrid.setHeader("No,Check,Nama Karyawan,Bagian,Jabatan,Email"),picGrid.attachHeader("#rspan,#rspan,#text_filter,#select_filter,#select_filter,#text_filter"),picGrid.setColSorting("int,na,str,str,str,str"),picGrid.setColAlign("center,left,left,left,left,left"),picGrid.setColTypes("rotxt,ch,rotxt,rotxt,rotxt,rotxt"),picGrid.setInitWidthsP("5,5,20,25,20,25"),picGrid.enableMultiselect(!0),picGrid.enableSmartRendering(!0),picGrid.attachEvent("onXLE",(function(){a.progressOff()})),picGrid.init(),picGrid.attachEvent("onCheckbox",(function(e,a,i){i?t.push(e):t.splice(t.indexOf(e),1)})),picGrid.clearAndLoad(RoomRev("getEmployees",{equal_sub_department_id:e.getItemValue("sub_department_id"),equal_status:"ACTIVE"}),r)}(e)})),e.attachEvent("onButtonClick",(function(a){switch(a){case"update":if(!e.validate())return eAlert("Input error!");setDisable(["update","cancel"],e,i.cells("b"));let a=new dataProcessor(AppMaster2("reqOvertimeForm"));a.init(e),e.save(),a.attachEvent("onAfterUpdate",(function(a,r,l,n){let s=n.getAttribute("message");switch(r){case"updated":sAlert("Berhasil Mengubah Record <br>"+s),o(),i.cells("b").progressOff(),i.cells("b").showView("tambah_req_overtime"),i.cells("b").collapse(),t=[];break;case"error":eAlert("Gagal Mengubah Record<br>"+s),setEnable(["update","cancel"],e,i.cells("b"))}}));break;case"cancel":i.cells("b").collapse(),i.cells("b").showView("tambah_req_overtime")}}))}()}})),r.attachEvent("onEnter",(function(e){switch(e){case"search":o(),s.attachEvent("onGridReconstructed",n)}}))}

JS;

header('Content-Type: application/javascript');
echo $script;