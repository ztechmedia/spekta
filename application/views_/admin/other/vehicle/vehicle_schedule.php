<?php 
if ((strpos(strtolower($_SERVER['SCRIPT_NAME']), strtolower(basename(__FILE__)))) !== false) { // NOT FALSE if the script"s file name is found in the URL
    header('HTTP/1.0 403 Forbidden');
    die('<h2>Direct access to this page is not allowed.</h2>');
}

$script = <<< "JS"

    function showVehicleSchedule(){var e,t,a,n=mainTab.cells("vehicle_schedule").attachLayout({pattern:"1C",cells:[{id:"a",header:!1}]});scheduler2=Scheduler.getSchedulerInstance(),scheduler2.clearAll(),n.cells("a").attachScheduler(null,"month",null,scheduler2);var l=reqJsonResponse(VehicleRev("getVehicles"),"GET",{});function s(){n.cells("a").progressOn(),scheduler2.clearAll();const e=scheduler2.getState(),t={mode:e.mode,date:e.date,min_date:e.min_date.toISOString(),max_date:e.max_date.toISOString()};scheduler2.load(VehicleRev("getEvents",t)),n.cells("a").progressOff()}a=l.detail,scheduler2.locale.labels.section_destination="Tujuan",scheduler2.locale.labels.section_trip_type="Tipe Perjalanan",scheduler2.locale.labels.section_description="Deskripsi Kegiatan",scheduler2.locale.labels.section_vehicle="Kendaraan",scheduler2.locale.labels.section_auto="Waktu Reservasi",scheduler2.locale.labels.section_driver="Driver",scheduler2.locale.labels.section_passenger="Penumpang",scheduler2.config.lightbox.sections=[{name:"destination",height:32,map_to:"destination",type:"textarea",focus:!0},{name:"trip_type",height:40,map_to:"trip_type",type:"select",options:[{key:"drop",label:"Pergi Saja (Drop)"},{key:"pp",label:"Pulang Pergi"}]},{name:"description",height:150,map_to:"description",type:"textarea"},{name:"vehicle",height:40,map_to:"vehicle",type:"select",options:l.data},{name:"time",height:72,type:"time",map_to:"auto"},{name:"driver",height:32,map_to:"driver",type:"textarea"},{name:"passenger",height:32,map_to:"passenger",type:"textarea"}],scheduler2.config.buttons_right=["dhx_save_btn","dhx_cancel_btn"],scheduler2.config.buttons_left=["dhx_delete_btn","driver_button","emp_button"],scheduler2.config.drag_resize=!1,scheduler2.config.drag_move=!1,scheduler2.config.drag_create=!1,scheduler2.config.time_step=30,scheduler2.config.first_hour=8,scheduler2.config.last_hour=16,scheduler2.locale.labels.driver_button="Driver",scheduler2.locale.labels.emp_button="Penumpang",scheduler2.attachEvent("onLightbox",(function(){scheduler2.formSection("driver").control.disabled=!0})),scheduler2.attachEvent("onLightboxButton",(function(n,l,s){if("driver_button"==n){var r=createWindow("driver","Daftar Driver",900,400);myWins.window("driver").skipMyCloseEvent=!0;var i=scheduler2.formSection("driver").getValue().split(",");r.attachToolbar({icon_path:"./public/codebase/icons/",items:[{id:"save",text:"Simpan",type:"button",img:"ok.png"}]}).attachEvent("onClick",(function(e){switch(e){case"save":const e=i.filter((e=>""!==e));scheduler2.formSection("driver").setValue(e),closeWindow("driver")}}));let t=r.attachStatusBar();function c(){var a=e.getRowsNum();t.setText("Total baris: "+a),i.length>0&&i.map((t=>""!==t&&e.cells(t,1).setValue(1)))}r.progressOn(),(e=r.attachGrid()).setImagePath("./public/codebase/imgs/"),e.setHeader("No,Check,Nama Karyawan,Sub Unit,Jabatan,Email"),e.attachHeader("#rspan,#rspan,#text_filter,#select_filter,#select_filter,#text_filter"),e.setColSorting("int,na,str,str,str,str"),e.setColAlign("center,left,left,left,left,left"),e.setColTypes("rotxt,ch,rotxt,rotxt,rotxt,rotxt"),e.setInitWidthsP("5,5,20,25,20,25"),e.enableSmartRendering(!0),e.attachEvent("onXLE",(function(){r.progressOff()})),e.init(),e.attachEvent("onCheckbox",(function(t,a,n){n?i.length>1?(eAlert("Hanya bisa memilih 1 Driver"),e.cells(t,1).setValue(0)):i.push(t):i.splice(i.indexOf(t),1)})),e.clearAndLoad(RoomRev("getEmployees",{equal_rank_id:"10",equal_status:"ACTIVE",notequal_email:""}),c)}else if("emp_button"===n){var o=createWindow("emp_vehicle","Penumpang",900,400);myWins.window("emp_vehicle").skipMyCloseEvent=!0;var h=[];if(""!==scheduler2.formSection("passenger").getValue()){scheduler2.formSection("passenger").getValue().split(",").map((e=>""!==e&&h.push(e)))}o.attachToolbar({icon_path:"./public/codebase/icons/",items:[{id:"save",text:"Simpan",type:"button",img:"ok.png"}]}).attachEvent("onClick",(function(e){switch(e){case"save":scheduler2.formSection("passenger").setValue(h),closeWindow("emp_vehicle")}}));let e=o.attachStatusBar();function d(){var a=t.getRowsNum();e.setText("Total baris: "+a),h.length>0&&h.map((e=>t.cells(e,1).setValue(1)))}var u=a[scheduler2.formSection("vehicle").getValue()].passenger_capacity;o.progressOn(),(t=o.attachGrid()).setImagePath("./public/codebase/imgs/"),t.setHeader("No,Check,Nama Karyawan,Bagian,Jabatan,Email"),t.attachHeader("#rspan,#rspan,#text_filter,#select_filter,#select_filter,#text_filter"),t.setColSorting("int,na,str,str,str,str"),t.setColAlign("center,left,left,left,left,left"),t.setColTypes("rotxt,ch,rotxt,rotxt,rotxt,rotxt"),t.setInitWidthsP("5,5,20,25,20,25"),t.enableSmartRendering(!0),t.attachEvent("onXLE",(function(){o.progressOff()})),t.init(),t.attachEvent("onCheckbox",(function(e,a,n){n?h.length>=u?(eAlert("Melebihi kapasitas penumpang!"),t.cells(e,1).setValue(0)):h.push(e):h.splice(h.indexOf(e),1)})),t.clearAndLoad(RoomRev("getEmployees",{notequal_rank_id:"10",equal_status:"ACTIVE",notequal_email:""}),d)}})),scheduler2.attachEvent("onViewChange",(function(e,t){s()})),$(".dhx_cal_tab").attr("style","dispay:none"),scheduler2.attachEvent("onClick",(function(e,t){return scheduler2._on_dbl_click(t||event),!1}));var r=new dataProcessor(VehicleRev("eventHandler"));r.init(scheduler2),r.setTransactionMode("JSON"),r.attachEvent("onBeforeUpdate",(function(e,t,a){return isLogin()})),r.attachEvent("onAfterUpdate",(function(e,t,a,n){let l=n.getAttribute("message");"inserted"===t||"updated"===t?(sAlert(l),s()):eAlert(l),s()})),s()}

JS;

header('Content-Type: application/javascript');
echo $script;
    