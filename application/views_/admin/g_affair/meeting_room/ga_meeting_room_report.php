<?php 
if ((strpos(strtolower($_SERVER['SCRIPT_NAME']), strtolower(basename(__FILE__)))) !== false) { // NOT FALSE if the script"s file name is found in the URL
    header('HTTP/1.0 403 Forbidden');
    die('<h2>Direct access to this page is not allowed.</h2>');
}

$script = <<< "JS"

	function showMeetingReport(){var t=mainTab.cells("ga_meeting_rooms_report").attachTabbar({tabs:[{id:"a",text:"Report Global",active:!0},{id:"b",text:"Report Ruangan"}]}),e=t.cells("a").attachToolbar({icon_path:"./public/codebase/icons/",items:[{id:"refresh",text:"Refresh",type:"button",img:"refresh.png"},{id:"export",text:"Export To Excel",type:"button",img:"excel.png"}]});let r=filterForMonth(new Date);t.cells("a").attachMenu({icon_path:"./public/codebase/icons/",items:[{id:"search",text:"<div style='width:100%'>Search: <input type='text' id='ga_start_mroom_report' readonly value='"+r.start+"' /> - <input type='text' id='ga_end_mroom_report' readonly value='"+r.end+"' /> <button id='ga_btn_ftr_mroom_report'>Proses</button>"}]}),new dhtmlXCalendarObject(["ga_start_mroom_report","ga_end_mroom_report"]);$("#ga_btn_ftr_mroom_report").on("click",(function(){checkFilterDate($("#ga_start_mroom_report").val(),$("#ga_end_mroom_report").val())&&(_(),p())})),e.attachEvent("onClick",(function(t){switch(t){case"refresh":_();break;case"export":l.toExcel("./public/codebase/grid-to-excel-php/generate.php"),sAlert("Export Data Dimulai")}}));var a=t.cells("a").attachStatusBar();function o(){let t=l.getRowsNum();a.setText("Total baris: "+t),sumGridToElement(l,16,"ga_rm_report_total_snack","ga_rm_report_total_snack_grand","money"),sumGridToElement(l,8,"ga_rm_report_total_hour","ga_rm_report_total_hour_grand","float"),sumGridToElement(l,11,"ga_rm_report_total_person","ga_rm_report_total_person_grand","int")}var l=t.cells("a").attachGrid();function _(){t.cells("a").progressOn();let e={betweendate_start_date:$("#ga_start_mroom_report").val()+","+$("#ga_end_mroom_report").val(),equal_status:"CLOSED",report:!0};l.clearAndLoad(GAOther("getMeetingRevGrid",e),o)}l.setHeader("No,No. Tiket,No. Ref,Topik Meeting,Jenis Meeting,Ruang Meeting,Waktu Mulai,Waktu Selesai,Druasi,Snack,Total Peserta,Konfirmasi Hadir,Konfirmasi Tidak Hadir,Belum Konfirmasi,Snack,Harga Snack,Total,Status,Alasan Penolakan,Created By,Updated By,DiBuat"),l.attachHeader("#rspan,#text_filter,#text_filter,#text_filter,#select_filter,#select_filter,#text_filter,#text_filter,#select_filter,#text_filter,#text_filter,#text_filter,#text_filter,#text_filter,#text_filter,#text_filter,#text_filter,#text_filter,#text_filter,#text_filter,#text_filter,#text_filter,#text_filter"),l.setColSorting("str,str,str,str,str,str,str,str,str,str,str,str,str,str,str,str,str,str,str,str,str,str,str"),l.setColTypes("rotxt,rotxt,rotxt,rotxt,rotxt,rotxt,rotxt,rotxt,rotxt,rotxt,rotxt,edtxt,rotxt,rotxt,rotxt,ron,ron,rotxt,rotxt,rotxt,rotxt,rotxt"),l.setColAlign("center,left,left,left,left,left,left,left,left,left,left,left,left,left,left,left,left,left,left,left,left,left"),l.setInitWidthsP("5,15,15,25,15,15,20,20,10,10,10,10,10,10,15,15,15,15,30,15,15,25"),l.attachFooter(",Total,,,,,,<span id='ga_rm_report_total_hour'>0</span> Jam,,,<span id='ga_rm_report_total_person'>0</span> Orang,,,,,<div id='ga_rm_report_total_snack'>0</div>,,,,,,"),l.attachFooter(",Total Peserta,<span id='ga_rm_report_total_person_grand'>0</span> Orang"),l.attachFooter(",Total Jam Reservasi,<span id='ga_rm_report_total_hour_grand'>0</span> Jam"),l.attachFooter(",Total Biaya Snack,<div id='ga_rm_report_total_snack_grand'>0</div>"),l.enableSmartRendering(!0),l.attachEvent("onXLE",(function(){t.cells("a").progressOff()})),l.setNumberFormat("0,000",15,".",","),l.setNumberFormat("0,000",16,".",","),l.init(),_(),t.cells("b").attachToolbar({icon_path:"./public/codebase/icons/",items:[{id:"export",text:"Export To Excel",type:"button",img:"excel.png"}]}).attachEvent("onClick",(function(t){switch(t){case"export":i.toExcel("./public/codebase/grid-to-excel-php/generate.php"),sAlert("Export Data Dimulai")}}));var n=t.cells("b").attachStatusBar();function s(){let t=i.getRowsNum();n.setText("Total baris: "+t),sumGridToElement(i,2,"ga_rmr_total_rev","ga_rmr_total_rev_grand","int"),sumGridToElement(i,3,"ga_rmr_total_person","ga_rmr_total_person_grand","int"),sumGridToElement(i,4,"ga_rmr_total_hour","ga_rmr_total_hour_grand","float"),sumGridToElement(i,5,"ga_rmr_total_snack","ga_rmr_total_snack_grand","money")}var i=t.cells("b").attachGrid();function p(){t.cells("b").progressOn();let e={betweendate_start_date:$("#ga_start_mroom_report").val()+","+$("#ga_end_mroom_report").val(),equal_status:"CLOSED"};i.clearAndLoad(GAOther("getMeetingRevGroupGrid",e),s)}i.setHeader("No,Nama Ruang Meeting,Total Reservasi,Total Peserta,Total Jam,Total Biaya Snack"),i.attachHeader("#rspan,#text_filter,#text_filter,#text_filter,#text_filter,#text_filter"),i.setColSorting("str,str,str,str,str,str"),i.setColTypes("rotxt,rotxt,rotxt,rotxt,rotxt,rotxt"),i.setColAlign("center,left,left,left,left,left"),i.setInitWidthsP("5,20,20,20,20,20"),i.attachFooter(",Total,<span id='ga_rmr_total_rev'>0</span>,<span id='ga_rmr_total_person'>0</span> Orang,<span id='ga_rmr_total_hour'>0</span> Jam,Rp. <span id='ga_rmr_total_snack'>0</span>"),i.attachFooter(",Total Reservasi (Meeting),<span id='ga_rmr_total_rev_grand'>0</span>"),i.attachFooter(",Total Peserta,<span id='ga_rmr_total_person_grand'>0</span> Orang"),i.attachFooter(",Total Jam,<span id='ga_rmr_total_hour_grand'>0</span> Jam"),i.attachFooter(",Total Biaya Snack,<span id='ga_rmr_total_snack_grand'>0</span>"),i.enableSmartRendering(!0),i.attachEvent("onXLE",(function(){t.cells("b").progressOff()})),i.init(),p()}

JS;

header('Content-Type: application/javascript');
echo $script;
